---
title: Comparaison entre méthodes de simulation de fluides
author: Michel Jean Joseph Donnet
date: \today
format:
    pdf:
        cite-method: biblatex
output-file: Rapport.pdf
toc: true
lang: fr-FR
documentclass: report
top-level-division: chapter
numbersections: true
bibliography: references.bib
header-includes:
    - \usepackage[margin=2.5cm,a4paper]{geometry}
    - \usepackage{fancyhdr}
    - \usepackage{lastpage}
    - \usepackage{hyperref}
    - \usepackage{graphicx}
    - \usepackage{wrapfig}
    - \pagestyle{fancy}
    - \fancyhf{}
    - \lhead{\nouppercase{\leftmark}}
    - \rhead{Université de Genève}
    - \lfoot{\put(0, -30) {\includegraphics[width=4cm]{./unige.jpg}}}
    - \rfoot{Page \thepage / \pageref{LastPage}}
    - \fancypagestyle{plain}{
        \fancyhf{}
        \renewcommand{\headrulewidth}{0pt}
        \lfoot{\put(0, -30) {\includegraphics[width=4cm]{./unige.jpg}}}
        \rfoot{Page \thepage / \pageref{LastPage}}
        }
---

# Introduction

La terre est appelée "La planète bleue".
En effet, près de 70% de la surface de la terre est recouverte d'eau, donnant ainsi une couleur bleue à la terre, comme les astronautes on pu constater lors de la mission Apollo de 1972.
De plus, la terre possède l'eau dans tous ses états: solide, liquide et gazeux.

L'eau est quelque chose qui a beaucoup intéressé les scientifiques de toutes les époques.
Nous pouvons notamment citer parmi eux le légendaire Archimède qui, au cours du 3ème siècle avant Jésus-Christ, utilisa le principe de la poussée d'Archimède afin de déterminer si une couronne était en or selon la légende.

Puis entre le 17ème et le 18ème siècle s'est démarqué le tristement célèbre Isaac Newton qui a donné la définition d'un fluide newtonien, qui est un fluide dont la viscosité reste constante indépendamment de la force s'exerçant sur celui-ci, donc un fluide ayant un comportement prévisible.

Grâce aux études d'Isaac Newton, le fieffé coquin Leonhard Euler d'origine bâloise établit au cours du 18ème siècle des équations modélisant l'écoulement d'un fluide parfait adiabatique, c'est à dire que la viscosité et les effets de la chaleur ne sont pas pris en compte.

Mais cela ne satisfit pas tous les scientifiques.
En effet, au cours du 19ème siècle, frustrés par l'impossibilité de modéliser des fluides visqueux, le mathématicien Henri Navier et le physicien Georges Gabriel Stokes décidèrent d'ajouter la notion de viscosité aux équations d'Euler, étendant ainsi les équations sur les fluides newtonien.
Leur travail fut reconnu et utilisé sous le nom d'équations de Navier-Stokes.
Même de nos jours, personne n'a encore réussi à trouver une forme analytique à ces équations.

Cependant, la technologie a fait de nombreux progrès surtout vers la fin du 20ème siècle avec l'apparition de l'ordinateur, ce qui permit aux scientifiques de tenter de résoudre les équations de Navier-Stokes grâce à des approximations et des méthodes numériques.
Plusieurs méthodes ont donc été créées, notamment la méthode Smoothed Particle Hydrodynamics (SPH), la méthode Fluid-Implicit Particles (FLIP) et la méthode Lattice Boltzmann Method (LBM).
Cependant, quelles sont les différences entre ces méthodes ?
Y-a-t-il une méthode plus rapide qu'une autre ?
Serait-il possible d'utiliser ces méthodes afin de faire du rendu en temps réel de haute qualité ?


# Méthodes de simulation de fluides

## Mécanique des fluides

Un fluide est composé de nombreuses particules.
À la différence d'un solide, un fluide est complètement déformable.

Il existe différent types de fluides, notamment:

- les gaz: ce sont des fluides composés de particules isolées mouvant en toute liberté et pouvant entrer en collision.
- les liquides: ce sont des fluides composés de particules liées entre elles par des liaisons faibles, comme les liaisons hydrogène.
Les particules ne peuvent donc pas se mouvoir en toute liberté, et lorsqu'une particule bouge, elle exerce une influence sur les autres particules liées à elle.

### Variables

- $\rho$ la masse volumique du fluide. C'est une fonction qui dépend de la position à l'intérieur du volume et du temps $t$.
- $V$ le vecteur vitesse du fluide. Il dépend également de la position à l'intérieur du volume et du temps $t$.
- $p$ la pression du fluide
- $f$ les forces externes s'appliquant sur le fluide (comme la force de gravité)
- $E$ l'énergie totale par unité de masse. On a $E = e + \frac{1}{2}\lVert V \rVert^2$
- $e$ l'énergie interne par unité de masse
- $\Sigma$ la contrainte de viscosité du fluide
- $q$ le flux de chaleur causé par conduction thermique
- $q_{R}$ le flux de chaleur causé par rayonnement

### Équations d'Euler

Les équations d'Euler sont un ensemble d'équations décrivant l'écoulement d'un fluide non visqueux.
Voici les 3 équations d'Euler:

#### Équation de continuité

L'équation de continuité se formule de la façon suivante:

$$\frac{\partial}{\partial t} \rho + \nabla (\rho V) = 0$$ {#eq-econt}

avec:
    
- $\frac{\partial}{\partial t} \rho$ nous donne la variation de la masse par unité de volume en fonction du temps
- $\nabla (\rho V)$ est le flux de masse. Il nous indique comment la masse se déplace et se redistribue dans le volume

Dans cette équation, nous pouvons voir que la variation de la masse doit être égale au flux de masse du fluide. Cela signifie que la masse du fluide suit le principe de conservation de la matière

#### Équation de la quantité de mouvement
    
Voici l'équation de la quantité de mouvement:

$$\frac{\partial}{\partial t}(\rho V) + \nabla \cdot \left(\rho V V^T \right) = - \nabla p  + \rho \cdot f $$ {#eq-emouv}

avec:

- $\rho \cdot f$ nous donne l'ensemble des forces externes s'appliquant par unité de volume
- $\nabla \cdot \left(\rho V V^T \right)$ représente le changement de vitesse dû au mouvement du fluide
- $\frac{\partial}{\partial t}(\rho V)$ est la variation temporelle de la quantité de mouvement 

Dans cette équation, nous avons d'une part la variation temporelle de la quantité de mouvement plus la répartition de la quantité de mouvement dans le fluide, et de l'autre part la force résultant des variations de la pression plus les autres forces externes. On peut donc reconnaître la 2ème loi de Newton disant que la quantité de mouvement est égal à la somme des forces.

#### Équation de l'énergie

Soit un liquide adiabatique, c'est à dire pour lequel la chaleur n'est pas prise en compte.

Voici l'équation de l'énergie:

$$\frac{\partial}{\partial t} \rho E + \nabla \cdot (\rho E V) = - \nabla \cdot (pV) + \rho g V$$ {#eq-eener}

avec:

- $\frac{\partial}{\partial t} \rho E$ est la variation temporelle de l'énergie par unité de volume.
- $\nabla \cdot (\rho E V)$ nous donne le flux d'énergie à travers le fluide, donc comment l'énergie est transportée dans le fluide
- $- \nabla \cdot (pV)$ est le travail de la pression sur le fluide
- $\rho f V$ est le travail des forces extérieures sur le fluide

Dans cette équation, il y a d'une part la somme entre la variation et le flux d'énergie, et d'autre part la somme du travail des forces s'exerçant sur le fluide. Cela découle du principe de conservation d'énergie: la somme du travail des forces est égale à l'énergie du fluide...

### Équations de Navier-Stokes

Les équations de Navier-Stokes sont basées sur les équations d'Euler.
Elles y ajoutent la notion de viscosité, qui représente les forces de friction interne au fluide.
Elles permettent donc de modéliser des fluides réels visqueux à la différence des équations d'Euler qui modélisent les fluides parfaits.

Voici les équations de Navier-Stokes:

#### Équation de continuité

Celle-ci ne diffère pas de l'équation de continuité d'Euler [-@eq-econt].
Ceci semble normal, car la masse du fluide, même dans un fluide visqueux, ne peut toujours pas être créée ni détruite, et suit toujours le principe de conservation de la matière.

#### Équation de la quantité de mouvement

Voici l'équation de la quantité de mouvement de Navier-Stokes:

$$
\frac{\partial}{\partial t}(\rho V) + \nabla \cdot \left(\rho V V^T \right)
= - \nabla p  + \nabla \Sigma +  \rho \cdot f
$$ {#eq-nmouv}

- $\nabla \Sigma$ est la force exerçée par la viscosité du fluide

Dans cette équation, la force exercée par la viscosité a été ajoutée à la somme des forces de l'équation [-@eq-emouv] d'Euler.
Ainsi, l'équation [-@eq-nmouv] suit toujours la 2ème loi de Newton

#### Équation de l'énergie

Voici l'équation de l'énergie de Navier-Stokes:

$$
\frac{\partial}{\partial t} \rho E + \nabla \cdot (\rho E V)
= - \nabla \cdot (pV) + \nabla \cdot \Sigma V + \rho f V + \nabla \cdot q + \nabla \cdot q_{R}
$$ {#eq-nener}

- $\nabla \cdot \Sigma V$ est le travail de la viscosité du fluide
- $\nabla \cdot q + \nabla \cdot q_{R}$ est le travail de la chaleur sur le fluide

L'équation de l'énergie de Navier-Stokes [-@eq-nener] ajoute à l'équation d'Euler [-@eq-eener] le travail de la viscosité et de la chaleur sur le fluide.
Ainsi, les fluides non adiabatiques sont également pris en compte par cette équation.

Dans la plupart des cas, l'équation de l'énergie n'est pas prise en compte lors de la simulation de fluides notamment à cause de la complexité du calcul.

## Méthode SPH

La méthode Smoothed Particle Hydrodynamics (SPH) a été inventée en 1977 par Bob Gingold et Joe Monaghan @gingold et indépendamment par Leon Lucy @lucy afin de simuler des phénomènes astrophysiques, tel que la formation et l'évolution d'une étoile ou d'une galaxie.
Il s'agissait tout d'abord d'une approche probabiliste.
Les équations de la mécanique des fluides pouvaient effectivement servir à décrire ce genre de phénomènes astrophysiques car il s'agit de gaz ou d'une multitude de corps évoluant d'une manière similaire à un liquide ou un gaz.

La méthode SPH s'est ensuite développée dans le domaine de la mécanique des fluides ou elle a servit notamment à modéliser non seulement des fluides compressibles et incompressibles, mais également des phénomènes thermiques et magnétiques.

Puis vers 1990, la méthode SPH a été étendue à la mécanique des structures afin de simuler par exemple des impact à forte vitesse ou des déchirures de matériaux grâce notamment au travail de Libersky et Petschek (citation ici).

De nos jour, la méthode SPH est encore utilisée dans la mécanique des fluides, mais également pour simuler des impacts haute vitesse, des fragmentations ou encore des explosions, si bien que le terme Hydrodynamics n'est plus adapté.
Cependant, pour des raisons historiques, on conserve le terme Hydrodynamics.

### principes de base

La méthode SPH représente le fluide comme un ensemble de particules interagissant entre elles.
Elle simule le comportement de chaque particule, donc il s'agit d'une méthode lagrangienne.

De plus, la méthode SPH est une méthode sans maillage, ce qui signifie en d'autres termes qu'elle ne nécessite pas de maillage fixe.
Cela implique que la méthode SPH peut être utilisée avec une taille de domaine adaptative, et est donc particulièrement adaptée pour des problèmes complexes car on ne fera que la quantité de calcul nécessaire.
Par exemple, si on pense à simuler un verre d'eau se renversant sur une table, la méthode SPH sera particulièrement adaptée car elle ne calculera que les endroits où le fluide est présent et pas toute la table comme le ferait une méthode avec maillage fixe qui devrait définir un domaine de calcul fixe et s'y tenir.

Elle ne tente pas de résoudre les équations du fluide dans une grille fixe.... (reformuler ?)

Comme la méthode SPH est une méthode sans maillage, elle utilise une technique d'interpolation afin de déterminer le résultat des équations aux dérivées partielles.

#### Interpolation

L'interpolation utilisée dans la méthode SPH est basée sur le principe que la distribution de Dirac $\delta(r)$, appelée par abus de langage fonction Dirac et définie dans l'équation [-@eq-dirac], peut être considérée comme l'élément neutre de la convolution, comme nous montre l'équation [-@eq-conv1].
Étant une distribution de probabilité, la fonction Dirac respecte la propriété d'une distribution, donc on a la propriété [-@eq-dirac1].
$$
\begin{aligned}
f * \delta(x)
&= \int_{y} f(y) \delta(y - x) \\
&= f(x)
\end{aligned}
$$ {#eq-conv1}

avec:

$$
\delta(x) = \left\{
\begin{aligned}
1 & \ \text{si} \ x = 0 \\
0 & \ \text{sinon}
\end{aligned}
\right.
$$ {#eq-dirac}

et:

$$
\int \delta(x) dx = 1
$$ {#eq-dirac1}

On définit donc une fonction noyau $W$ qui est une approximation de la fonction Dirac et qui respecte les propriétés [-@eq-propW1] et [-@eq-propW2].

$$
\int_{r}W(r, h)dr = 1
$$ {#eq-propW1}
$$
\lim_{h\rightarrow 0} W(r, h) = \delta(r)
$$ {#eq-propW2}

L'équation [-@eq-conv1] devient alors l'équation [-@eq-conv2].

$$
\begin{aligned}
f * W(x)
&= \int_{y} f(y) W(y - x) \\
&\approx f(x)
\end{aligned}
$$ {#eq-conv2}

La méthode SPH simule le fluide comme un ensemble de particules.
Ces particules possèdent leurs caractéristiques propres tel que leur masse, leur position, leur vitesse.
Une particule interagit avec les particules l'avoisinant à travers un noyau de lissage $W$.
Cependant, une particule ne peut pas interagir avec toutes les particules...
Par exemple, on ne veut pas qu'une particule à une extrémité du fluide interagisse avec une particule à l'autre extrémité du fluide.
Ainsi, une distance $h$ est fixée afin que les particules qui se trouvent à une distance supérieur à $h$ ne possèdent pas d'influence sur la particule.
Ainsi, on peut définir une équation [-@eq-inter] qui décrit comment une propriété physique $A_{S}$ à un point donné du fluide est calculée grâce aux propriétés physiques $A_{i}$ des particules avoisinant le point donné, pondéré par le noyau de lissage $W$ donnant l'influence des particules avoisinantes, comme nous pouvons le voir sur la figure [-@fig-W].

$$
A_{S}(r) = \sum_{i} m_{i} \frac{A_{i}}{\rho_{i}}W(r - r_{i}, h)
$$ {#eq-inter}

avec:

- $m_{i}$ la masse de la particule $i$
- $A_{i}$ une propriété de la particule $i$
- $\rho_{i}$ la densité de la particule $i$
- $W$ le noyau utilisé pour l'interpolation
- $h$ le rayon d'influence du noyau d'interpolation. Ainsi, on a $W = 0$ si $|r - r_{i}| > h$.

![créée par @W](./images/W.png){#fig-W .figure-right width=30%}

La méthode SPH donne donc les propriétés physiques d'un point donné par une combinaison des propriétés des particules voisines.
Dans notre cas, la méthode SPH résoud l'équation de la conservation de la masse [-@eq-econt] et l'équation de la conservation de la quantité de mouvement [-@eq-nmouv], mais pas l'équation de la conservation de l'énergie [-@eq-nener], car la température n'est pas prise en compte.

Pour plus de précisions, consultez le travail de thèse de Fabien Caleyron @Fabien, mais également le travail de master de Marcus Vesterlund @Marcus et le travail de thèse de Alban Vergnaud @Alban.
Cette partie a été écrite principalement avec les informations données par @Marcus et @Alban.

#### Avantages

Les principaux avantages de la méthode SPH sont que celle-ci est une méthode

- sans maillage: en effet, cela permet à la méthode SPH de simuler des problèmes avec une dynamique de frontière complexe tel que des fluides à surface libre ou des fluides avec beaucoup de déplacement de frontières.
  De plus, l'avantage de la méthode sans maillage est sa facilité d'implémentation et surtout de parallélisation.
  En effet, il est plus facile de séparer le calcul entre plusieurs unités de calcul, car on regarde en chaque point du fluide quels sont ses caractéristiques locales.

- Comme nous l'avons mentionné plus haut, la méthode SPH peut également être utilisée d'une manière plus générale comme pour la simulation d'impact à haute vitesse sur un matériaux ou encore pour la simulation d'explosions ou de fragmentations.

- qui permet une bonne conservation de la masse... (À développer ???)


#### Désavantages

Cependant, la méthode SPH possède également des inconvénients.
En effet, cette méthode n'est pas bien définie aux frontières, ce qui rend la méthode difficile à calculer, comme le faisait remarquer @Shadloo.
Mais des travaux ont été faits afin de palier à ce problème, tel que @Adam et @Kostorz.

(À compléter !!!)


## Méthode LBM

La méthode Lattice Boltzman (LBM) est issue d'une autre méthode appelée lattice gaz automata (LGA)

### Principes de base

La méthode LBM représente le fluide comme un ensemble de particules qui elles-mêmes représentent un ensemble de molécules.
Elle est utilisée pour étudier le comportement de mésoscale fluides. (De l'ordre de $10^{-9}$ à $10^{-6}$ mètres)

Comme on représente non pas chaque molécule mais des groupes de molécule, la physique utilisée est probabilistique.

Les équations alors utilisées ne sont pas les équations de Navier Stokes, mais les équations de Boltzmann.

La méthode LBM utilise les équations de Boltzmann, mais n'est pas un solveur pour ces équations...

On peut représenter l'espace comme un ensemble de molécules dans une grille, et on est intéressé de savoir comment les molécules vont entrer en collision...

On veut connaître où vont les molécules en moyenne et quelle est leur distribution dans l'espace de vitesse

Dans les équations de Navier-Stokes, on a le temps et la position comme variable, mais dans la méthode LBM, on prend également la vélocité des molécules comme une variable.

On définit alors $\xi$ comme dans l'équation [-@eq-xi] où $\xi$ est la vélocité moléculaire qui donne le changement de position de la molécule en fonction du temps

On veut savoir combien de molécules dans une cellule se déplacent dans une direction à un temps donné.

his enable continuum level descriptions on a kinetic level where molecules are behaving kinetically
Cela permet des descriptions au niveau du continuum à un niveau cinétique où les molécules se comportent de manière cinétique.
Cela permet d'avoir un 

$$
\xi = \frac{dx}{dt}
$$ {#eq-xi}

$$
f(\xi, x, t)
$$
Donne le nombre de molécules que l'on a à un point donné à un temps donné qui bougent dans une direction donnée avec une vitesse donnée.

Cette distribution $f$ est normalisée de telle façon que si on intègre sur la vitesse et la position, on obtient la masse du système:

$$
\int d^3 \xi \int d^3 x f(\xi, x, t) = M(t)
$$

Et si on intègre sur seulement la vélocité, on obtient la densité car cela correspond à seulement prendre toutes les molécules, sans tenir compte de leur vitesse.

$$
\int d^3 \xi f(\xi, x, t) = \rho(x, t)
$$

Si on calcule le premier moment de la distribution, donc si on multiplie par la vitesse des molécules et qu'ensuite on intègre en fonction de la vitesse, on obtient le moment de densité du système pour une cellule donnée.

$$
\int d^3 \xi \xi \cdot f(\xi, x, t) = \rho u(x, t)
$$

On peut faire la même chose pour obtenir la pression, mais c'est plus compliqué.

On est intéressé par la densité et le moment de densité car ces variables apparraissent dans les équations de Navier-Stokes.

$f$ contient toutes les propriétés locales du fluide qui nous intéressent.
Si on va au niveau des équations de Navier Stokes, on est uniquement intéressé par obtenir les moments de $f$, ce qui signifie le moment d'ordre 0 qui est la densité et le moment d'ordre 1 qui est le moment de densité

On veut trouver une équation qui décrit comment $f$ évolue dans le temps

On peut utiliser la règle de chainage et obtenir:

$$
\begin{aligned}
\frac{df(\xi, x, t)}{dt}
&= (\frac{\partial}{\partial t} + \frac{dx}{dt}\cdot \frac{\partial}{\partial x} + \frac{d\xi}{dt} \cdot \frac{\partial}{\partial \xi}) f(\xi, x, t) \\
&= (\frac{\partial}{\partial t} + \xi \cdot \frac{\partial}{\partial x} + \frac{f}{\rho} \cdot \frac{\partial}{\partial \xi}) f(\xi, x, t) \\
&= \Omega (f)
\end{aligned}
$$

terme 1: dérivée parielle en fonction du temps
terme 2: gradient spacial
terme 3: le changement de vélocité est l'accélération et l'accélération des particules est relié à la force agissant sur les particules

mais dans la réalité, les particules entrent en collision, ce qui va faire que la fonction de distribution va changer non seulement à cause des termes présent dans sa dérivée, mais également parce que les particules entrent en collision, et toutes ces contributions qui ne sont pas capturées par la dérivée sont collectées par la partie droite qui donne la déviation de 0 et qui est appelée l'opérateur de collision $\Omega$.

On peut retrouver les équations de Navier Stokes à partir des équations de Boltzmann avec certaunes conditions et limites.

Navier Stokes vs boltzmann: Navier Stokes plus simple car possède seulement les données en fonction du temps et de la position: la vitesse $\xi$ n'est pas prise en compte...

Les équations de Boltzman n'ont pas de détails microscopiques

La fonction de distribution va être déformée par l'opérateur de collision.
On ne prend pas en compte chaque collision, sinon le calcul devient monstrueux, mais on peut estimer que au bout d'un moment, on arrive à un équilibre. On appelle $f^{eq}$ la distribution équilibrée.
On estime alors que l'on peut modéliser la relaxation vers $f^{eq}$ à partir d'un état non équilibré $f$ par un modèle Bhatnagar-Gross-Krook (BGK):

$$
\Omega (f) =- \frac{1}{\tau} (f - f^{eq})
$$
avec $\tau$ le temps de relaxation

C'est une grosse simplification, mais cela marche tout de même avec les équations de Boltzmann dans une simulation numérique, et cette simplification est suffisante pour retrouver le comportement des équations de Navier-Stokes.

On définit
- $\xi$ la vélocité absolue de nos molécules
- $u = \int d^3 \xi \xi \cdot \frac{f(\xi, x, t)}{\rho}$ est la vélocité moyenne du fluide dans la cellule. C'est la vélocité moyenne des molécules dans une surface donnée. C'est la vitesse macroscopique du liquide à un point donné
- $v = \xi - u$ comme la vitesse du centre de masse de ces molécules. Il donne comment les molécules sont distribuées individuellement dans l'espace des vitesses autour de la vélocité u.

On utilise communément $u$ et $v$ et non pas $\xi$.

Les collisions doivent conserver la masse (densité), le moment (vélocité) (3ème loi de newton) et l'énergie (température) (collisions sont élastiques...)
La distribution d'équilibre $f^{eq}$ doit dépendre seulement de la densité $\rho$, la vitesse du centre de masse $v$ et de la température $T$. et elle doit être isotropique.
elle doit être isotrope, peu importe la direction de l'espace dans lequel nous regardons, elle ne peut donc dépendre que de la magnitude de v
On arrive après des dérivations à la fonction de distribution équilibrée [-@eq-eqdist]

$$
\begin{aligned}
f^{eq} (v, x, t) &= \rho \left(\frac{1}{2\pi RT}\right)^{3/2} e^{-\frac{|v|^2}{2RT}} \\
&= \rho \left(\frac{1}{2\pi RT}\right)^{3/2} e^{-\frac{|\xi - u|^2}{2RT}} \\
\end{aligned}
$${#eq-eqdist}

Qu'est ce qu'on a appris ?

- séparation dans le temps et dans l'espace
- remplacement des molécules par une fonction de distribution $f(v, x, t)$ (mesoscopic picture)
- Boltzmann équation: équation gouvernant la distribution $f$
- On a besoin de l'opérateur de collision $\Omega (f)$ qui est très complexe dans sa forme matématique
- On utilise un opérateur de collision simplifié grâce à BGK qui nous donne une distribution équilibrée $f^{eq}$
- On peut calculer la densité $\rho$, la vélocité $u$ et la pression $p$ macroscopique du fluide grâce aux moments de $f(v, x, t)$
- On peut retrouver les équations de Navier Stokes

we can use a navier stokes server that is not directly distretizing the navier-stokes equations but that is rooted in boltzmann theory
Nous pouvons utiliser un serveur de Navier-Stokes qui ne distord pas directement les équations de Navier-Stokes mais qui est enraciné dans la théorie de Boltzmann.

L'idée principale est d'utiliser les équations de Boltzmann pour résoudre les équations de Navier-Stokes, ce qui est possible grâce à Chapman-Enskog.

Nous allons simuler l'évolution de la fonction de densité $f$ plutôt que l'évolution de la vitesse et de la pression, ce qui nous intéresse normalement dans un fluide microscopique...

Pourquoi utiliser la méthode Boltzmann ?? En effet, il y a plus de variables, cela a l'air plus difficile...
On utilise cette méthode car elle s'avère plus pratique qu'une discrétisation des équations de Navier-Stokes.

On a donc à
- Discrétiser la fonction de distribution $f$
- Qu'est ce que la lattice boltzman equation (LBE)
- comment sont liés l'équation de Navier-stokes et l'équation de boltzmann ?

Espace: 
$x \rightarrow \Delta x$ (lattice). On prend l'espace et on le décompose en "small lattice nodes" et on résoud l'équation pour chaque noeud du treillis (ou de la lattice...)

Temps:
$t \rightarrow \Delta t$ qui est constant... Donc on résoud lattice boltzmann à un temps t, puis on avance de $\Delta t$.... On peut également faire le temps dynamiquement...

Vélocité:
$f(v, x, t) \rightarrow f_{i}(x, t)$ On discrétise $f$ en terme d'espace de vélocité en autorisant seulement un très petit nombre de directions possibles de direction et de vitesse. (Notation D2Q9: 9 vélocité possibles en 2d... D3Q19: 19 vélocité possibles en 3d)

Vélocité:

Ce que l'on fait est que l'on dit que si on a une molécule ou $f$ n'est pas réellement une molécule, mais un ensemble de molécules
Au lieu de dire $f$ décrit comment les molécules bougent dans toutes les directions, on dit que les molécules peuvent maintenant bouger seulement sur les axes primaires $x$, $y$, $z$ ou elles peuvent bouger sur les diagonales, et elles doivent se déplacer de telle sorte qu'en un pas de temps delta t, elles atteignent exactement l'un des noeuds de treillis voisins.
Donc la discrétisation de l'espace de vélocité est fait de telle sorte qu'il est parfaitement aligné avec la discrétisation temporelle et spacialle.

On doit donc remplacer les intégrales par des sommes finies qui n'ont que peu de termes comme 9 ou 19 plutôt que 1 million
Le mécanisme mathématique derrière cela est "Hermite expansion" que je ne vais pas expliquer.

$$(c_{i}) = \begin{bmatrix} 0 & 1 & 0 & -1 & 0 & 1 & -1 & -1 & 1 \\ 0 & 0 & 1 & 0 & -1 & 1 & 1 & -1 & -1\end{bmatrix} \frac{\Delta x}{\Delta t}$$
pour D2Q9....

Une fois que l'on a fait cela, on écrit $q$ différente population $f_{i}(x, t)$, une pour chaque $c_{i}$

On a donc:

$$
\sum_{i}^{q - 1} f_{i}(x, t) = \rho(x, t)
$$
et 
$$
\sum_{i}^{q - 1} c_{i} f_{i}(x, t) = \rho u(x, t)
$$

Au lieu de l'oppérateur de collision, on utilise l'approximation BGK et l'équation résultante sera la lattice boltzmann equation ou lattice bgk equation (lbgk)

$$
f_{i}(x + c_{i}\Delta t, t + \Delta t) - f_{i}(x, t) = -\frac{\Delta t}{\tau}(f_{i}(x, t) - f_{i}^{eq}(x, t) = \Omega_{i}
$$
avec

- $f_{i}(x + c_{i}\Delta t, t + \Delta t)  - f_{i}(x, t)$ une population $i$ donnée évaluée dans un point $x$ et un temps $t$ et sa contrepartie se sera déplacée de $c_{i} \times \Delta t$ où $c_{i}$ est la vitesse de la population.
- $-\frac{\Delta t}{\tau}(f_{i}(x, t) - f_{i}^{eq}(x, t)$ la distribution $f_{i}$ qui va se relaxer vers la distribution équilibrée $f_{i}^{eq}$ en un temps $\frac{\Delta t}{\tau}$

Ce qui nous donne si on réécrit cela:
$$
f_{i}(x + c_{i}\Delta t, t + \Delta t) = f_{i}(x, t) -\frac{\Delta t}{\tau}(f_{i}(x, t) - f_{i}^{eq}(x, t) = \Omega_{i}
$$

Le terme de relaxation nous donne un déplacement ou une redistribution de notre population, mais elle n'a pas encore bougé dans l'espace, et ensuite, on la propage vers les autres voisins.

Les avantages sont que les collisions sont locales et algébriques: c'est un algorithme très simple pour les collisions et la propagation est linéaire et exacte, ce qui signifie que l'on peut décomposer le lattice solveur en étape de collision et de propagation.

Dans Navier-Stokes, on a la notion de viscosité alors que dans Boltzmann, on a seulement un temps de relaxation.
On a ainsi la relation suivante:
$$
visc = c_{S}^2\left(\tau - \frac{\Delta t}{2}\right)
$$

avec la vitesse du son $c_{S}$ définie comme suit:
$$
c_{S} = \frac{1}{\sqrt{3}}\frac{\Delta x}{\Delta t}
$$

et $f_{i}^{eq}$ qui est une simplification de la distribution de Maxwell-Boltzmann défini comme suit:

$$
f_{i}^{eq} = w_{i} \rho \left(1 + \frac{c_{i} \cdot u}{c_{S}^2} + \frac{(c_{i} \cdot u)^2}{2c_{S}^4} - \frac{u \cdot u}{2c_{S}^2} \right)
$$
avec $w_{i}$ le poids d'une population dépendant de si la population se déplace le long des axes principaux ou diagonaux ou si elle reste sur place ( en effet, il peut changer de valeur suivant ces critères....)

Comment on fait ?

- Condition initiale. On connaît le $f_{i}$ initial. On peut donc calculer la densité et la vélocité par la somme des moments de $f$
- Ensuite, on calcule la distribution équilibrée $f^{eq}$ qui dépend uniquement de la densité et de la vélocité.
- Puis on peut calculer la distribution post collision $f_{i}^*$. Nos populations auront été redistribués dans l'espace de vélocité, mais n'auront pas bougé.
  On peut alors propager cela aux voisins: $f_{i}(x + c_{i}\Delta t, t + \Delta t) = f_{i}^*$.

Pourquoi ça marche ?

- On a une "lattice symetry and isotropy"
- On a la conservation de la masse et de la quantité de mouvement: $\sum_{i}\Omega_{i} = 0$ et $\sum_{i} c_{i}\Omega_{i} = 0$
- Les analyses de Champman-Enskog nous montre que ce que l'on a fait (donc que LBE) est suffisant pour retrouver le comportement de Navier-Stokes.

1. Avantages
   - C'est rapide car c'est une méthode explicite et linéaire en propagation
   - On n'a pas d'équation de poisson à résoudre (à la différence des équations de Navier-Stokes)
   - C'est une méthode locale exepté pour la propagation aux voisins
   - Facilement parallélisable (très scallable: linéaire en fonction du nombre de coeurs...)
   - Les géométries complexes peuvent être implémentées relativement facilement comparée aux autres méthodes

2. Désavantages
   - On ne peut simuler que des "small Knudsen numbers" et des "small Mach numbers"


Ce qu'on a appris

- Discrétiser la distribution $f$
- Discrétiser la vélocité $f(v, x, t) \rightarrow f_{i}(x, t)$
- Simple à implémenter
- $\tau$ détermine la viscosité du fluide
- la méthode est rapide, facilement parallélisable, et peut être utilisée pour résoudre des systèmes complexes de géométrie
- mais la méthode n'est pas faite pour simuler des high Knudsen ou high Mach numbers


Pour simuler des problèmes de différente taille, il faut bien définir les conditions aux bords...
Les conditions aux bords sont nécessaires non seulement mathématiquement, mais aussi physiquement.
En général, on a des approches non structurées (comme la méthode SPH), des approches structurées (comme la méthode LBM)
Il faut faire attention car si on ne s'occupe pas bien des conditions aux bords, le résultat sera mauvais...

La lattice boltzmann a un zoo pour les conditions aux bords car on a plus de variable que dans les équations de Navier-Stokes.
Par exemple, en 3d, on a 4 champs hydrodynamiques, on a la pression et on a la vélocité qui possède 3 composantes et le stress tensor $\sigma$ qui possède 6 composantes (le stress tensor est utilisé pour déterminer ce qui se passe aux bords du fluide....). Cependant, on a plus de populations...
On a 19 ou 27 populations, ce qui signifie que l'on a plus de liberté dans LBM que dans Navier-Stokes, mais que l'on a plus de conditions à imposer et à satisfaire...

D'une manière générale, on manipule des populations $f_{i}$.
Pour savoir ce qui se passe aux conditions, nous devons savoir ce qui vient depuis l'extérieur, donc on va se dire que l'on a un $f$ qui vient de l'extérieur, et on va essayer de déterminer ce qu'il devrait être.

De nombreuses personnes se sont penchés sur le problème de condition aux bords et ils ont déterminer de nombreuses conditions aux bords, ayant chacune leur avantage et leur désavantage.
On a notamment les Bounce-back methods (simple, interpolée, partiellement saturée), les Ghost methods (FH & MLS, GZS, Image-based) et les Immerse Boundary methods (Explicit, Direct forcing, other variants)

On peut par exemple définir pour Bounce-back methode que si on passe la frontière, on a $f_{i} \rightarrow f_{\hat{i}}$ avec $c_{\hat{i}} = - c_{i}$. Ainsi, on n'ajoute pas de nouvelles informations.
Cette méthode marche pour toute les conditions de bord en escalier, est extrêmement simple et ne possède pas d'équivalent dans les CFD (computationnal fluid dynamics)
mais elle n'est pas très précise, il y a des artéfacts numériques et si on bouge les bords, on aura des complications

Conditions de bord immersive (excellent article de Peskin en 2002 !) Un principe de base est que les frontières vont bouger avec le fluide. Cette méthode n'est pas une condition de bord, mais elle ne fait que mimer l'effet d'un bord.

Avantages: pas besoin d'inclure des conditions de bord réelles, l'effet sur le fluide est complètement inclus avec les forces externes, fonctionne pour des bords de n'importe quelle forme

Désavantages: impact sur la précision due à diffuse interface method, le fluide existe à l'intérieur des bords, plus difficile pour les conditions limites autres que l'absence de glissement...

Comme on n'a pas d'équation de poisson à résoudre, lbm est utile pour le calcul haute performance

Explications prise de cette vidéo: @Krueger2.
